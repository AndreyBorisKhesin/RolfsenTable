(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      5211,        167]
NotebookOptionsPosition[      4966,        154]
NotebookOutlinePosition[      5312,        169]
CellTagsIndexPosition[      5269,        166]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"XS", "@", "K_"}], ":=", 
   RowBox[{"K", "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Xp", "@", "i__"}], "\[RuleDelayed]", 
       SubscriptBox["Xp", "i"]}], ",", 
      RowBox[{
       RowBox[{"Xm", "@", "i__"}], "\[RuleDelayed]", 
       SubscriptBox["Xm", "i"]}], ",", 
      RowBox[{
       RowBox[{"X", "@", "i__"}], "\[RuleDelayed]", 
       SubscriptBox["X", "i"]}], ",", 
      RowBox[{
       SubscriptBox["X", 
        RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}]], "\[RuleDelayed]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"j", "\[Equal]", 
           RowBox[{"l", "+", "1"}]}], "||", 
          RowBox[{
           RowBox[{"j", "\[Equal]", "1"}], "&&", 
           RowBox[{"l", "\[NotEqual]", "2"}]}], "||", 
          RowBox[{
           RowBox[{"k", "\[Equal]", "l"}], "&&", 
           RowBox[{"j", "\[NotEqual]", "k"}]}]}], ",", 
         SubscriptBox["Xp", 
          RowBox[{"l", ",", "i"}]], ",", 
         SubscriptBox["Xm", 
          RowBox[{"j", ",", "i"}]]}], "]"}]}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PD", "@", "K_"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", "=", 
       RowBox[{
        RowBox[{"2", 
         RowBox[{"Length", "[", 
          RowBox[{"X", " ", "K"}], "]"}]}], "-", "2"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"XS", "@", "K"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         SubscriptBox["Xp", 
          RowBox[{"a_", ",", "b_"}]], "\[RuleDelayed]", 
         SubscriptBox["X", 
          RowBox[{"b", ",", 
           RowBox[{
            RowBox[{"Mod", "[", 
             RowBox[{"a", ",", "x"}], "]"}], "+", "1"}], ",", 
           RowBox[{
            RowBox[{"Mod", "[", 
             RowBox[{"b", ",", "x"}], "]"}], "+", "1"}], ",", "a"}]]}], ",", 
        RowBox[{
         SubscriptBox["Xm", 
          RowBox[{"a_", ",", "b_"}]], "\[RuleDelayed]", 
         SubscriptBox["X", 
          RowBox[{"b", ",", "a", ",", 
           RowBox[{
            RowBox[{"Mod", "[", 
             RowBox[{"b", ",", "x"}], "]"}], "+", "1"}], ",", 
           RowBox[{
            RowBox[{"Mod", "[", 
             RowBox[{"a", ",", "x"}], "]"}], "+", "1"}]}]]}]}], "}"}]}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"L", "@", "n_"}], ":=", 
   RowBox[{"k", "=", 
    RowBox[{"{", "}"}]}]}], ";", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"q", "=", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "n"}], "}"}]}], "]"}], ",", "1", ",", "1", ",", 
        "1", ",", "1"}], "}"}], "}"}]}], ",", 
    RowBox[{
     RowBox[{"Length", "@", "q"}], ">", "0"}], ",", 
    RowBox[{"q", "=", 
     RowBox[{"Delete", "[", 
      RowBox[{"q", ",", "1"}], "]"}]}], ",", 
    RowBox[{
     RowBox[{"w", "=", 
      RowBox[{"q", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
     ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", 
         RowBox[{
         "w", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "\[Equal]", "12"}], ",", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"a", ",", 
         RowBox[{
         "w", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "]"}],
        ","}], "]"}]}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"G", "@", "0"}], ":=", 
   RowBox[{"{", 
    RowBox[{"{", "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R", "@", "n_"}], ":=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{"Length", "@", 
     RowBox[{"G", "@", "i"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0", ",", "n"}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAGIQbZZp6KYY9drxhc5pPxBtsko6GERLNKqA6Vvs8jUg
uq9uYh+IPqT6ewaIthG4Pw9EW3dvXAyirzTHLwHRdos3PwbRSzI8noPoY8JC
b0G01+eg3yA6o2kLqxKQVmp35QXRN51eCILoK1sNREC0WOBrCRB96IWVNIi+
7HfOHkSb/bzvBaL3eAlGg+g1vJPyQPTdj+0lIFrNw6AMLD+7RVwFSPNpOUuA
aNk/pcog+sqTWB0QbbbbwARE9xT1gemdD2ZagOgHLHMtQfS9idcdQfT/mdVu
IPpo2lQvEB0k+csbRP+L2R4Iorem7AsB0UfWXIkA0VkBPyJB9MXJRwtA9A4x
piIQrZARWwaiL8kV1YPorqaeHhAtJ3OuF0QDALzArDk=
  "]]
},
WindowSize->{1366, 685},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"10.0 for Microsoft Windows (64-bit) (December 4, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 4404, 132, 156, "Input"]
}
]
*)

(* End of internal cache information *)
