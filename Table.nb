(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     18541,        468]
NotebookOptionsPosition[     17766,        437]
NotebookOutlinePosition[     18112,        452]
CellTagsIndexPosition[     18069,        449]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"G", "@", "n_"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"f", "=", 
        RowBox[{"n", "!"}]}], ",", 
       RowBox[{"l", "=", 
        RowBox[{"Permutations", "@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"2", "j"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "n"}], "}"}]}], "]"}]}]}], ",", "k", ",", 
       RowBox[{"t", "=", 
        RowBox[{"{", "}"}]}]}], "}"}], ",", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", "f"}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{
        RowBox[{"k", "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"2", "j"}], "-", "1"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "n"}], "}"}]}], "]"}], ",", 
            RowBox[{
            "l", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
           "}"}], "\[Transpose]"}]}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"PlanarGraphQ", "@", 
           RowBox[{"Graph", "@", 
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   "\[UndirectedEdge]", 
                  RowBox[{
                   RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"2", "n"}]}], "]"}], "+", "1"}]}], ",", 
                 RowBox[{
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
                   "\[UndirectedEdge]", 
                  RowBox[{
                   RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"2", "n"}]}], "]"}], "+", "1"}]}]}], "}"}], "&"}],
               "/@", "k"}], "]"}]}]}], ",", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"t", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"List", "@@", "#"}], "&"}], "/@", "k"}]}], "]"}], 
           ";"}]}], "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{"Length", "@", "t"}]}], ",", 
        RowBox[{"i", "++"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Or", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                 "-", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], "]"}], "\[Equal]", "1"}], 
              "&"}], "/@", 
             RowBox[{
             "t", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
            ")"}]}], ",", 
          RowBox[{
           RowBox[{"t", "=", 
            RowBox[{"Delete", "[", 
             RowBox[{"t", ",", "i"}], "]"}]}], ";", 
           RowBox[{"i", "--"}], ";"}]}], "]"}]}], "]"}], ";"}], "*)"}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"G", "@", "0"}], ":=", 
   RowBox[{"{", 
    RowBox[{"{", "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"R", "@", "n_"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"Length", "@", 
      RowBox[{"G", "@", "i"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", "n"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.671413915658964*^9, 3.67141396432638*^9}, {
   3.6714494787420025`*^9, 3.671449540253319*^9}, {3.6714496097125006`*^9, 
   3.6714496131317835`*^9}, {3.6714497905581465`*^9, 
   3.6714497986623707`*^9}, {3.6714498419530525`*^9, 
   3.6714499465225983`*^9}, {3.671449992421568*^9, 3.671450004927894*^9}, {
   3.671450036008376*^9, 3.671450122410796*^9}, {3.671450154825186*^9, 
   3.671450167900688*^9}, {3.6714506413895564`*^9, 3.671450657036397*^9}, {
   3.6714543646605225`*^9, 3.671454411620332*^9}, {3.6714544484464626`*^9, 
   3.6714545804495544`*^9}, {3.671455036363081*^9, 3.671455103688831*^9}, {
   3.671455149674969*^9, 3.67145525245689*^9}, {3.671455298106475*^9, 
   3.6714553189254885`*^9}, {3.6714554139691043`*^9, 
   3.6714554167630157`*^9}, {3.6714554630418205`*^9, 
   3.6714555104943233`*^9}, {3.6714559980750694`*^9, 3.671456005808758*^9}, {
   3.671456132944645*^9, 3.6714561338302407`*^9}, 3.671496727240961*^9, 
   3.6714967604475145`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "@", 
  RowBox[{"G", "@", "8"}]}]], "Input",
 CellChangeTimes->{{3.6714501703508625`*^9, 3.6714501712829714`*^9}, 
   3.671450214758711*^9, {3.671450665994523*^9, 3.671450696513838*^9}, {
   3.671451295029013*^9, 3.671451295180414*^9}, {3.6714513548704033`*^9, 
   3.6714513568080454`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"62.734375`7.818105488910437", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.671451372505322*^9, 3.6714543483936863`*^9, 
  3.671496755713579*^9, 3.6714967915793085`*^9, 3.6714968624465857`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "@", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"n", "=", "8"}], ",", "i", ",", "j", ",", "q", ",", "t", ",", 
      "l", ",", "c", ",", "r", ",", 
      RowBox[{"a", "=", "1"}], ",", "b", ",", "o", ",", "s", ",", "p", ",", 
      "h", ",", "m"}], "}"}], ",", 
    RowBox[{
     RowBox[{"t", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"k", ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "n"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"r", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"n", "!"}]}], "}"}]}], "]"}]}], ";", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "0"}], ",", 
       RowBox[{"i", "<", 
        RowBox[{"n", "!"}]}], ",", 
       RowBox[{
        RowBox[{"i", "++"}], ";", 
        RowBox[{"b", "=", "True"}]}], ",", 
       RowBox[{
        RowBox[{"j", "=", "i"}], ";", 
        RowBox[{"c", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"k", ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "n"}], "}"}]}], "]"}]}], ";", 
        RowBox[{"l", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"q", "=", 
             RowBox[{"QuotientRemainder", "[", 
              RowBox[{"j", ",", 
               RowBox[{"k", "!"}]}], "]"}]}], ";", 
            RowBox[{"j", "=", 
             RowBox[{
             "q", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
            ";", 
            RowBox[{
             RowBox[{
             "q", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "+",
              "1"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", 
             RowBox[{"n", "-", "1"}], ",", "0", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j", "=", "1"}], ",", 
          RowBox[{"b", "&&", 
           RowBox[{"j", "\[LessEqual]", "n"}]}], ",", 
          RowBox[{"j", "++"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{
            "t", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], "=", 
            RowBox[{"c", "\[LeftDoubleBracket]", 
             RowBox[{
             "l", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
             "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"h", "=", 
            FractionBox[
             RowBox[{"n", "-", "1"}], "2"]}], ";", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"s", "=", "0"}], ",", 
             RowBox[{
              RowBox[{"s", "<", "j"}], "&&", 
              RowBox[{"s", "<", "h"}]}], ",", 
             RowBox[{"s", "++"}], ",", 
             RowBox[{
              RowBox[{"p", "=", 
               RowBox[{"t", "\[LeftDoubleBracket]", 
                RowBox[{
                 RowBox[{"j", "-", "s"}], ";;", "j"}], 
                "\[RightDoubleBracket]"}]}], ";", 
              RowBox[{"m", "=", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Min", "@", "p"}], ",", 
                 RowBox[{"Max", "@", "p"}]}], "}"}]}], ";", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"m", "\[Equal]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"j", "-", "s"}], ",", "j"}], "}"}]}], "||", 
                 RowBox[{"m", "\[Equal]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"j", "-", "s", "-", "1"}], ",", 
                    RowBox[{"j", "-", "1"}]}], "}"}]}]}], ",", 
                RowBox[{
                 RowBox[{"i", "+=", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "-", "j"}], ")"}], "!"}], "-", "1"}]}], ";", 
                 RowBox[{"b", "=", "False"}], ";", 
                 RowBox[{"Break", "[", "]"}]}]}], "]"}]}]}], "]"}], ";", 
           RowBox[{"If", "[", 
            RowBox[{"b", ",", 
             RowBox[{"c", "=", 
              RowBox[{"Delete", "[", 
               RowBox[{"c", ",", 
                RowBox[{
                "l", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}],
                "]"}]}], ",", 
             RowBox[{"Break", "[", "]"}]}], "]"}]}]}], "]"}], ";", 
        RowBox[{"If", "[", 
         RowBox[{"b", ",", 
          RowBox[{
           RowBox[{"o", "=", 
            RowBox[{"Ordering", "@", "t"}]}], ";", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"PlanarGraphQ", "@", 
              RowBox[{"Graph", "@", 
               RowBox[{"Flatten", "[", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"k", "\[UndirectedEdge]", 
                    RowBox[{
                    "o", "\[LeftDoubleBracket]", "k", 
                    "\[RightDoubleBracket]"}]}], ",", 
                    RowBox[{"k", "\[UndirectedEdge]", 
                    RowBox[{"o", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"k", "-", "2"}], ",", "n"}], "]"}], "+", "1"}], 
                    "\[RightDoubleBracket]"}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"k", ",", "n"}], "}"}]}], "]"}], "]"}]}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{
               "r", "\[LeftDoubleBracket]", "a", "\[RightDoubleBracket]"}], 
               "=", "t"}], ";", 
              RowBox[{"a", "++"}]}]}], "]"}]}], ",", 
          RowBox[{"Continue", "[", "]"}]}], "]"}]}]}], "]"}], ";", 
     RowBox[{"a", "-", "1"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.671495360401065*^9, 3.6714954068737803`*^9}, {
   3.671495500724288*^9, 3.6714955185406823`*^9}, {3.6714956814861917`*^9, 
   3.6714956818713818`*^9}, {3.6714958090493717`*^9, 3.671495876790922*^9}, {
   3.6714960145195565`*^9, 3.671496035010414*^9}, {3.671496163702091*^9, 
   3.6714962999537663`*^9}, {3.6714963426349077`*^9, 3.671496342892846*^9}, {
   3.671496439555297*^9, 3.67149645293125*^9}, {3.6714965948288717`*^9, 
   3.6714966053932*^9}, {3.671496644034088*^9, 3.6714966479759817`*^9}, {
   3.6714994428534927`*^9, 3.6714995136142273`*^9}, {3.671499545846204*^9, 
   3.6714996294061613`*^9}, {3.6714997585116687`*^9, 
   3.6714997588276787`*^9}, {3.671499824671569*^9, 3.6714998254088497`*^9}, {
   3.6714998560438156`*^9, 3.671499862282078*^9}, {3.6714999988185377`*^9, 
   3.6715000016041393`*^9}, {3.6715000449973564`*^9, 3.671500078956097*^9}, {
   3.671500113749982*^9, 3.671500250561653*^9}, {3.6715003069059944`*^9, 
   3.671500308455289*^9}, {3.6715003878273993`*^9, 3.6715004036134033`*^9}, {
   3.671500742005329*^9, 3.6715009027970915`*^9}, {3.671500945651102*^9, 
   3.67150107121008*^9}, {3.6715011044131703`*^9, 3.6715011695337763`*^9}, {
   3.6715012295020523`*^9, 3.6715012366529245`*^9}, {3.671501283958064*^9, 
   3.671501338883383*^9}, {3.671541215950983*^9, 3.6715412345601196`*^9}, {
   3.6715414650443125`*^9, 3.6715414757240143`*^9}, {3.671543373938131*^9, 
   3.6715434096815615`*^9}, {3.6715437990841265`*^9, 3.671543815855332*^9}, {
   3.671543939056673*^9, 3.671543967187934*^9}, {3.6715441187458572`*^9, 
   3.671544134834116*^9}, {3.671544789804024*^9, 3.671544792765025*^9}, {
   3.6715448868772535`*^9, 3.671544893684998*^9}, {3.671546287058905*^9, 
   3.6715462925668573`*^9}, {3.671546373716419*^9, 3.6715464393956227`*^9}, 
   3.6715464724223967`*^9, {3.6715465033747616`*^9, 3.671546765725855*^9}, {
   3.6715468980763083`*^9, 3.6715469025475006`*^9}, {3.671546977462064*^9, 
   3.671546986270904*^9}, {3.6715471258411193`*^9, 3.671547125963068*^9}, {
   3.6715471848897552`*^9, 3.6715471923774014`*^9}, {3.6715473733227353`*^9, 
   3.671547406593087*^9}, {3.6715474473366003`*^9, 3.6715474650003595`*^9}, {
   3.671557588244012*^9, 3.6715576458055596`*^9}, {3.6715577077040462`*^9, 
   3.671557773917029*^9}, {3.67156133847488*^9, 3.6715615316361885`*^9}, {
   3.671561812675396*^9, 3.6715618927707753`*^9}, {3.6715619352570496`*^9, 
   3.6715619854923306`*^9}, {3.671562095652608*^9, 3.6715621316904707`*^9}, {
   3.6715622005186243`*^9, 3.6715622283687735`*^9}, {3.6715623054933295`*^9, 
   3.6715623275765934`*^9}, {3.671562397852858*^9, 3.671562411566024*^9}, {
   3.671562443004512*^9, 3.671562455928749*^9}, {3.6715625046399927`*^9, 
   3.6715625521352987`*^9}, 3.6715625929436426`*^9, {3.6715626485342255`*^9, 
   3.671562740685641*^9}, {3.671562786700055*^9, 3.6715627964067326`*^9}, {
   3.671562923094945*^9, 3.671563004737501*^9}, {3.671563043363283*^9, 
   3.6715630474142694`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"9.5`6.998323518568472", ",", "2387"}], "}"}]], "Output",
 CellChangeTimes->{{3.671496640884948*^9, 3.671496656826517*^9}, 
   3.671499507791361*^9, {3.671499614349007*^9, 3.6714996310469303`*^9}, {
   3.6714997599518538`*^9, 3.6714997740243177`*^9}, {3.671501316951852*^9, 
   3.6715013402227345`*^9}, 3.671541476949765*^9, {3.671543945412965*^9, 
   3.671543967814355*^9}, 3.671544135344874*^9, {3.671544837807276*^9, 
   3.6715448571296196`*^9}, 3.671544894570304*^9, {3.6715464028886924`*^9, 
   3.671546434221064*^9}, {3.671546470103468*^9, 3.6715464778599644`*^9}, {
   3.6715466015410576`*^9, 3.6715466420055523`*^9}, {3.6715466804718304`*^9, 
   3.671546738699993*^9}, 3.671546776387451*^9, 3.6715469084847083`*^9, {
   3.671547168268485*^9, 3.671547197221376*^9}, 3.6715474698965197`*^9, 
   3.6715575824008846`*^9, 3.671557656652872*^9, {3.6715577132641277`*^9, 
   3.671557725718292*^9}, {3.671557781017011*^9, 3.6715577880868797`*^9}, {
   3.671562536106617*^9, 3.671562556176693*^9}, 3.6715627525459375`*^9, {
   3.671562787317808*^9, 3.6715627969845753`*^9}, {3.6715629327002153`*^9, 
   3.671563013465802*^9}, 3.6715631414130726`*^9, 3.6715631824316587`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Ordering", "[", 
  RowBox[{"{", 
   RowBox[{"4", ",", "8", ",", "2", ",", "10", ",", "6"}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.671500411518676*^9, 3.671500432402996*^9}, {
   3.671500476202952*^9, 3.671500482701544*^9}, 3.671500622433467*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3", ",", "1", ",", "5", ",", "2", ",", "4"}], "}"}]], "Output",
 CellChangeTimes->{{3.6715004537252684`*^9, 3.6715004830330515`*^9}, 
   3.6715006229156556`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"4", ",", "8", ",", "2", ",", "10", ",", "6"}], "}"}]], "Output",
 CellChangeTimes->{3.6715006271400757`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"2", 
  RowBox[{"{", 
   RowBox[{"2", ",", "3", ",", "1", ",", "5", ",", "4"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.671544030640544*^9, 3.671544093559697*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"4", ",", "6", ",", "2", ",", "10", ",", "8"}], "}"}]], "Output",
 CellChangeTimes->{3.671544063711648*^9, 3.671544094409171*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "3", ",", "5", ",", "7", ",", "9"}], "}"}]], "Input"]
},
WindowSize->{1366, 685},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"10.0 for Microsoft Windows (64-bit) (December 4, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 5255, 138, 132, "Input"],
Cell[CellGroupData[{
Cell[5838, 162, 323, 6, 31, "Input"],
Cell[6164, 170, 241, 4, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6442, 179, 8921, 196, 475, "Input"],
Cell[15366, 377, 1212, 17, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16615, 399, 280, 6, 31, "Input"],
Cell[16898, 407, 201, 4, 31, "Output"],
Cell[17102, 413, 148, 3, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17287, 421, 187, 4, 31, "Input"],
Cell[17477, 427, 168, 3, 31, "Output"]
}, Open  ]],
Cell[17660, 433, 102, 2, 31, "Input"]
}
]
*)

(* End of internal cache information *)
